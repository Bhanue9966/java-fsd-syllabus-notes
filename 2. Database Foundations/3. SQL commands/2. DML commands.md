## ðŸ› ï¸ Data Manipulation Language (DML) Commands (01\_database\_foundations/02\_setup\_basics/04\_dml\_commands.md)

DML commands are used to manage and modify the data stored within the tables of a database. Unlike DDL operations, DML operations (except for `TRUNCATE`, which is DDL) are generally **not automatically committed** and can be reversed using the **ROLLBACK** command, allowing for transaction control.

-----

### 1\. INSERT Command

The `INSERT` command is used to add one or more new rows (records) into a table.

#### A. Inserting a Single Row (Specifying Columns)

This is the most explicit and recommended way, as it works even if the table structure changes (e.g., adding a new column with a `DEFAULT` value).

```sql
-- Syntax (Specifying columns and values)
INSERT INTO table_name (column1, column2, ...)
VALUES (value1, value2, ...);

-- Example: Adding a new department
INSERT INTO Departments (dept_id, dept_name)
VALUES (101, 'Sales');
```

#### B. Inserting a Single Row (Implicit Columns)

This requires the values to be listed in the exact order the columns were defined in the table. **Avoid this method** if the column order is likely to change.

```sql
-- Syntax (Implicit columns - all columns must be provided)
INSERT INTO table_name
VALUES (value1, value2, ...);

-- Example: Adding an employee (assuming (emp_id, first_name, last_name, salary, hire_date, dept_id) order)
INSERT INTO Employees
VALUES (5001, 'Alice', 'Smith', 65000.00, '2025-05-15', 101);
```

#### C. Inserting Multiple Rows in a Single Statement

Many modern SQL databases support inserting several rows efficiently using a single `INSERT` statement.

```sql
-- Syntax (Inserting multiple rows)
INSERT INTO table_name (column1, column2, ...)
VALUES
    (value_A1, value_A2, ...),
    (value_B1, value_B2, ...),
    (value_C1, value_C2, ...);

-- Example: Adding multiple employees
INSERT INTO Employees (emp_id, first_name, last_name, salary, dept_id)
VALUES
    (5002, 'Bob', 'Johnson', 55000.00, 101),
    (5003, 'Charlie', 'Brown', 80000.00, 102);
```

#### D. Inserting Data from Another Table (`INSERT INTO ... SELECT`)

Used to copy data from one table to another, based on a query result.

```sql
-- Syntax
INSERT INTO target_table (column1, column2, ...)
SELECT source_column1, source_column2, ...
FROM source_table
WHERE condition;

-- Example: Copying high-salary employees to an 'Executive' table
INSERT INTO Executives (exec_id, exec_name, dept_id)
SELECT emp_id, first_name || ' ' || last_name, dept_id
FROM Employees
WHERE salary > 100000;
```

-----

### 2\. SELECT Command

The `SELECT` command is used to retrieve data from a database. While often categorized separately as a Query Language command (QL), it is fundamental to DML operations, especially when used in conjunction with `UPDATE` and `DELETE`.

#### A. Basic Data Retrieval

```sql
-- Syntax (Retrieving specific columns)
SELECT column1, column2, ...
FROM table_name;

-- Syntax (Retrieving all columns)
SELECT *
FROM table_name;

-- Example: Get first and last names of all employees
SELECT first_name, last_name
FROM Employees;
```

#### B. Data Retrieval with Filtering

The `WHERE` clause is used to filter records based on a specified condition.

```sql
-- Syntax
SELECT column1, ...
FROM table_name
WHERE condition;

-- Example: Find employees in department 101 earning over 60000
SELECT first_name, last_name, salary
FROM Employees
WHERE dept_id = 101 AND salary > 60000.00;
```

-----

### 3\. UPDATE Command

The `UPDATE` command is used to modify existing data within a table.

#### A. Updating Specific Records

It is crucial to include a **`WHERE` clause** to specify which rows to modify. **Without a `WHERE` clause, the operation will affect ALL rows in the table.**

```sql
-- Syntax
UPDATE table_name
SET column1 = new_value1, column2 = new_value2, ...
WHERE condition;

-- Example: Give a 10% raise to all employees in department 101
UPDATE Employees
SET salary = salary * 1.10
WHERE dept_id = 101;
```

#### B. Updating Multiple Columns

```sql
-- Example: Update salary and department for a specific employee
UPDATE Employees
SET salary = 95000.00, dept_id = 102
WHERE emp_id = 5001;
```

#### C. Updating based on a Subquery

```sql
-- Example: Update the 'notes' column in the 'Projects' table based on the 'Status' table
UPDATE Projects
SET notes = 'Overdue'
WHERE project_id IN (
    SELECT project_id
    FROM Status
    WHERE due_date < CURRENT_DATE()
);
```

-----

### 4\. DELETE Command

The `DELETE` command is used to remove one or more existing rows from a table.

#### A. Deleting Specific Records

Similar to `UPDATE`, a **`WHERE` clause** is used to target specific rows. **Without a `WHERE` clause, the operation will delete ALL rows in the table.**

```sql
-- Syntax
DELETE FROM table_name
WHERE condition;

-- Example: Remove the employee with ID 5003
DELETE FROM Employees
WHERE emp_id = 5003;
```

#### B. Deleting All Records

This removes all data from the table but keeps the table structure intact. This is slower than `TRUNCATE` and generates transaction logs.

```sql
-- Example: Delete all records from the 'TempData' table
DELETE FROM TempData;
```

> **Note:** The difference between **`DELETE FROM table_name;`** (DML) and **`TRUNCATE TABLE table_name;`** (DDL) is that **`DELETE`** is logged and reversible (`ROLLBACK`), but slower for large tables, while **`TRUNCATE`** is faster, resets identity columns, and is generally irreversible/auto-committed.

-----

### 5\. Transaction Control Language (TCL) Commands

TCL commands are closely related to DML, as they manage the changes made by DML commands. They are used to group DML statements into logical transactions.

| Command | Description |
| :--- | :--- |
| **COMMIT** | Makes all DML changes permanent in the database. |
| **ROLLBACK** | Undoes all DML changes since the last `COMMIT` or `ROLLBACK`. |
| **SAVEPOINT** | Creates a point within a transaction to which you can later `ROLLBACK`. |

#### A. COMMIT and ROLLBACK

```sql
-- Start of a transaction (often implied by the first DML statement)

-- Perform DML operation 1
UPDATE Employees SET salary = 100000 WHERE emp_id = 5001;

-- Perform DML operation 2
INSERT INTO Departments (dept_id, dept_name) VALUES (103, 'Marketing');

-- If changes are correct:
COMMIT;

-- OR, if changes were incorrect and need to be undone:
ROLLBACK;
```

#### B. SAVEPOINT (for partial ROLLBACK)

```sql
-- Start of a transaction

-- DML 1
INSERT INTO TempData (col) VALUES ('Step A');
SAVEPOINT A;

-- DML 2
INSERT INTO TempData (col) VALUES ('Step B');
SAVEPOINT B;

-- DML 3 (might be an error or unwanted)
INSERT INTO TempData (col) VALUES ('Step C');

-- Rollback to point B, undoing only DML 3
ROLLBACK TO B;

-- Make DML 1 and DML 2 permanent
COMMIT;
```

Would you like me to generate the notes for the next logical section, which is typically **Data Control Language (DCL) Commands**?