## ðŸ”’ Constraints in SQL

Constraints are rules enforced on data columns in a table. They are used to limit the type of data that can go into a table, ensuring the **accuracy and reliability** of the data in the database. If any data manipulation operation violates a constraint, the action is aborted.

-----

### 1\. Types of Constraints

Constraints can be applied at two levels:

1.  **Column Level:** Applied only to one column.
2.  **Table Level:** Applied to one or more columns as a group.

| Constraint | Purpose | Key Properties |
| :--- | :--- | :--- |
| **NOT NULL** | Ensures a column cannot have a `NULL` value. | Column-level only. |
| **UNIQUE** | Ensures all values in a column or set of columns are distinct. | Column or Table-level. |
| **PRIMARY KEY** | Uniquely identifies each record in a table. A combination of **NOT NULL** and **UNIQUE**. | Column or Table-level (one per table). |
| **FOREIGN KEY** | Links two tables together, enforcing **referential integrity**. | Column or Table-level. |
| **CHECK** | Ensures all values in a column satisfy a specific condition. | Column or Table-level. |
| **DEFAULT** | Provides a default value for a column when no value is specified. | Column-level only (technically not a integrity constraint but affects data assignment). |

-----

### 2\. Defining Constraints

Constraints can be defined when the table is created (`CREATE TABLE`) or added later (`ALTER TABLE`).

#### A. Defining Constraints at Creation Time (`CREATE TABLE`)

This is the preferred method for defining constraints, especially **Primary Keys** and **Foreign Keys**.

```sql
CREATE TABLE Products (
    -- 1. Column-Level Constraints (NOT NULL, UNIQUE, PRIMARY KEY)
    product_id INT PRIMARY KEY, -- PRIMARY KEY is implicitly NOT NULL and UNIQUE
    product_name VARCHAR(100) NOT NULL UNIQUE,
    price DECIMAL(10, 2) CHECK (price > 0), -- CHECK constraint
    supplier_id INT,

    -- 2. DEFAULT Constraint (sets a default value)
    status VARCHAR(20) DEFAULT 'Available',

    -- 3. Table-Level Constraints (defined separately)
    CONSTRAINT uk_product_code UNIQUE (product_name, supplier_id), -- Composite UNIQUE Key

    -- 4. Table-Level FOREIGN KEY Constraint
    CONSTRAINT fk_supplier
        FOREIGN KEY (supplier_id)
        REFERENCES Suppliers(supplier_id)
        -- Referential Actions (Optional but recommended):
        ON DELETE CASCADE
        ON UPDATE NO ACTION
);
```

-----

### 3\. Modifying and Dropping Constraints

The `ALTER TABLE` command is used to add, drop, or sometimes modify existing constraints.

#### A. Adding New Constraints

To add a new constraint after the table is created, you use `ALTER TABLE`.

```sql
-- 1. Adding a NOT NULL constraint (Syntax varies by database, using standard MODIFY)
ALTER TABLE Employees
MODIFY COLUMN email VARCHAR(100) NOT NULL;

-- 2. Adding a new UNIQUE constraint (Table-level)
ALTER TABLE Employees
ADD CONSTRAINT uk_employee_email UNIQUE (email);

-- 3. Adding a CHECK constraint
ALTER TABLE Employees
ADD CONSTRAINT chk_salary_min CHECK (salary >= 40000);

-- 4. Adding a FOREIGN KEY constraint
ALTER TABLE Projects
ADD CONSTRAINT fk_project_manager
FOREIGN KEY (manager_id)
REFERENCES Employees(emp_id);
```

#### B. Dropping Constraints

To drop a constraint, you typically reference its defined name (if it has one). If a name was not explicitly provided, the database assigns a default, usually vendor-specific, name.

```sql
-- 1. Dropping a PRIMARY KEY constraint (syntax varies)
ALTER TABLE Employees
DROP PRIMARY KEY;

-- 2. Dropping a specific Foreign Key (using its defined name)
ALTER TABLE Projects
DROP CONSTRAINT fk_project_manager;

-- 3. Dropping a specific CHECK constraint (using its defined name)
ALTER TABLE Employees
DROP CONSTRAINT chk_salary_min;

-- 4. Dropping a NOT NULL constraint (Syntax varies by database vendor)
-- MySQL:
ALTER TABLE Employees
MODIFY COLUMN email VARCHAR(100) NULL;

-- SQL Server:
ALTER TABLE Employees
ALTER COLUMN email VARCHAR(100) NULL;
```