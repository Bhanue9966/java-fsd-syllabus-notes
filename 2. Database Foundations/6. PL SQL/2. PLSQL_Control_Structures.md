## ðŸ“ PL/SQL Control Structures

Control structures are procedural statements that manage the flow of execution within a PL/SQL block. They allow your code to make **decisions** (conditional control) and **repeat actions** (iterative control).

-----

### 1\. Conditional Control (Decision Making)

Conditional statements execute different sets of code based on whether a specified condition evaluates to `TRUE`, `FALSE`, or `NULL`.

#### A. `IF...THEN...END IF`

The simplest form executes a sequence of statements only if the condition is `TRUE`.

```sql
DECLARE
    v_salary_increase NUMBER := 0.0;
    v_job_title       VARCHAR2(50) := 'Senior Manager';
BEGIN
    IF v_job_title = 'Senior Manager' THEN
        v_salary_increase := 0.10;
    END IF;

    DBMS_OUTPUT.PUT_LINE('Increase factor: ' || v_salary_increase);
END;
/
```

#### B. `IF...THEN...ELSE...END IF`

Executes one block of code if the condition is `TRUE` and a different block if it is `FALSE` or `NULL`.

```sql
DECLARE
    v_order_status VARCHAR2(20) := 'Shipped';
BEGIN
    IF v_order_status = 'Pending' THEN
        DBMS_OUTPUT.PUT_LINE('Checking inventory.');
    ELSE
        DBMS_OUTPUT.PUT_LINE('Order is already processed.');
    END IF;
END;
/
```

#### C. `IF...ELSIF...ELSE...END IF`

Handles multiple mutually exclusive conditions sequentially. The first condition that evaluates to `TRUE` is executed, and the rest are skipped.

```sql
DECLARE
    v_score NUMBER := 85;
    v_grade VARCHAR2(1);
BEGIN
    IF v_score >= 90 THEN
        v_grade := 'A';
    ELSIF v_score >= 80 THEN -- Executes if the first condition was FALSE
        v_grade := 'B';
    ELSIF v_score >= 70 THEN
        v_grade := 'C';
    ELSE
        v_grade := 'F';
    END IF;

    DBMS_OUTPUT.PUT_LINE('Grade: ' || v_grade);
END;
/
```

#### D. `CASE` Statement

Provides an elegant alternative to complex `IF...ELSIF` chains, especially when comparing a single expression against multiple possible values.

```sql
DECLARE
    v_day_number NUMBER := 3;
    v_day_name   VARCHAR2(10);
BEGIN
    CASE v_day_number
        WHEN 1 THEN v_day_name := 'Sunday';
        WHEN 2 THEN v_day_name := 'Monday';
        WHEN 3 THEN v_day_name := 'Tuesday';
        -- The ELSE clause handles all non-matching cases (optional)
        ELSE v_day_name := 'Invalid Day';
    END CASE;

    DBMS_OUTPUT.PUT_LINE('Day: ' || v_day_name);
END;
/
```

-----

### 2\. Iterative Control (Looping)

Looping structures execute a sequence of statements repeatedly.

#### A. Basic Loop (`LOOP...EXIT WHEN...END LOOP`)

The simplest loop structure, which executes at least once and must contain an explicit **`EXIT WHEN`** condition to prevent an infinite loop.

```sql
DECLARE
    v_counter NUMBER := 1;
BEGIN
    LOOP
        DBMS_OUTPUT.PUT_LINE('Count: ' || v_counter);
        v_counter := v_counter + 1;

        -- Exit condition
        EXIT WHEN v_counter > 5;
    END LOOP;
END;
/
```

#### B. `WHILE` Loop

Tests the exit condition at the **beginning** of each iteration. The body of the loop executes only if the condition is initially `TRUE`.

```sql
DECLARE
    v_counter NUMBER := 1;
BEGIN
    WHILE v_counter <= 5 LOOP
        DBMS_OUTPUT.PUT_LINE('Count: ' || v_counter);
        v_counter := v_counter + 1;
    END LOOP;
END;
/
```

#### C. Numeric `FOR` Loop

Used for a fixed number of iterations. The counter variable is implicitly declared by PL/SQL and is automatically incremented or decremented. **You cannot change the loop counter variable manually inside the loop.**

```sql
BEGIN
    -- Loop from 1 to 5 (inclusive). The counter 'i' is automatically declared.
    FOR i IN 1..5 LOOP
        DBMS_OUTPUT.PUT_LINE('Iteration: ' || i);
    END LOOP;

    -- Reverse loop (from high to low)
    FOR j IN REVERSE 1..3 LOOP
        DBMS_OUTPUT.PUT_LINE('Reverse Iteration: ' || j);
    END LOOP;
END;
/
```

-----

### 3\. Simple Control (`GOTO` and Labels)

The `GOTO` statement transfers control unconditionally to a specific labeled point within the same PL/SQL block.

  * **Caution:** `GOTO` makes code very difficult to read, debug, and maintain. Its use is almost universally **discouraged** in modern programming practices, except in rare cases for exiting deeply nested structures to an exception handler.

<!-- end list -->

```sql
DECLARE
    v_check NUMBER := 10;
BEGIN
    GOTO first_step; -- Unconditional jump

    -- This section is skipped
    DBMS_OUTPUT.PUT_LINE('Skipped code.');

    <<first_step>> -- The label is defined by double angle brackets
    v_check := v_check + 5;
    DBMS_OUTPUT.PUT_LINE('Final Check: ' || v_check);
END;
/
```