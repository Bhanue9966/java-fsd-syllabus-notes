# üóÑÔ∏è Persistence and ORM

## 1\. JDBC Introduction and Setup

**JDBC (Java Database Connectivity)** is a Java API that provides a standard mechanism for Java applications to communicate with various relational databases (RDBs). It acts as a bridge between the Java application and the database driver.

### 1\. The JDBC Architecture üåâ

JDBC defines a set of interfaces and classes that enable a Java application to issue SQL queries and process the results. The key components are:

1.  **JDBC API:** The standard Java interfaces (`Connection`, `Statement`, `ResultSet`, etc.) used by the application developer.
2.  **Driver Manager:** A utility class that manages the different database drivers available in the system.
3.  **JDBC Driver:** A specific software component provided by the database vendor (e.g., PostgreSQL, MySQL, Oracle) that translates the standard JDBC calls into the database's native protocol.

### 2\. The Seven Essential JDBC Steps

The core process of executing an SQL query via JDBC, demonstrated in your `DemoJdbc` class, involves seven sequential steps:

#### Step 1: Import the JDBC Package üì¶

The necessary classes (`Connection`, `Statement`, `ResultSet`, etc.) are located in the `java.sql.*` package.

```java
import java.sql.Connection;
import java.sql.DriverManager;
// ... and others
```

#### Step 2: Load and Register the Driver (Older Java / Explicitly)

While often implicit since Java 6, traditionally, the driver class needed to be explicitly loaded into memory. This is handled by the **Driver Manager**.

```java
// Not strictly required since Java 6, but common in legacy code
// Class.forName("org.postgresql.Driver"); 
```

#### Step 3: Create the Connection üîó

This is the most critical step. You use the static **`DriverManager.getConnection()`** method, passing the unique connection URL, username, and password.

  * **JDBC URL:** Specifies the database type, location (host/port), and database name.
      * *Your Example:* `jdbc:postgresql://localhost:5432/demo`

<!-- end list -->

```java
String url = "jdbc:postgresql://localhost:5432/demo";
String uname = "postgres";
String pass = "6031";

Connection con = DriverManager.getConnection(url, uname, pass);
System.out.println("Connection established");
```

#### Step 4: Create a Statement Object ‚úçÔ∏è

The `Connection` object creates a `Statement` object, which is used to carry the SQL query to the database.

```java
Statement st = con.createStatement();
```

#### Step 5: Execute the Statement üöÄ

The `Statement` executes the raw SQL query.

  * **`executeQuery(String sql)`:** Used for `SELECT` queries (returns data).

  * **`executeUpdate(String sql)`:** Used for `INSERT`, `UPDATE`, `DELETE` (returns count of affected rows).

  * *Your Example:*

    ```java
    String sql = "select * from student";
    ResultSet rs = st.executeQuery(sql); // Returns data in a ResultSet
    ```

#### Step 6: Process the Results (Iterating the `ResultSet`) üìä

If a `SELECT` query is executed, the results are stored in a **`ResultSet`** object. This object holds a cursor, which initially points *before* the first row.

  * The **`rs.next()`** method moves the cursor to the next row and returns `true` if a row exists, allowing you to iterate through all results.

  * Data is retrieved using **`getXXX(int columnIndex)`** or **`getXXX(String columnName)`**.

  * *Your Example:*

    ```java
    while (rs.next()){ // Loops through every row
        // 1 refers to the first column (s_id), 2 to the second (s_name), etc.
        System.out.print(rs.getInt(1) + " - "); 
        System.out.print(rs.getString(2) + " - ");
        System.out.println(rs.getInt(3));
    }
    ```

#### Step 7: Close the Connection and Resources üö™

It is critical to close the resources (especially the `Connection`) to release the database resources and prevent connection leaks. Resources should be closed in reverse order of creation.

```java
con.close(); // Closing the connection automatically closes the Statement and ResultSet
System.out.println("Connection closed");
```

