# üåê 7. Spring Web MVC and REST

## 06-view-data-model.md

### üì¶ Passing Data from Controller to View

After a Controller processes an incoming request and performs any necessary business logic, it needs to hand off the resulting data (the **Model**) to the **View** so it can be rendered as HTML, XML, or JSON.

Spring MVC provides several mechanisms for the Controller to interact with the Model, most commonly by using the **`Model`** interface.

### 1\. The `Model` Interface

The `Model` interface in Spring MVC acts as a simple container for transferring data between the Controller and the View. It is essentially a map (`String` key $\rightarrow$ `Object` value).

#### A. Injecting the `Model`

A Controller method can accept a parameter of type `Model`. Spring MVC automatically instantiates this object and injects it into the method before execution.

#### B. Adding Attributes

You use the `Model.addAttribute()` method to place data into the Model container. This data will be accessible by the View template.

#### Code Example: Using the `Model` Interface

Assume we have a `User` POJO and want to display its details in a view named `user-details`.

**`src/main/java/com/example/web/UserController.java`**

```java
package com.example.web;

import com.example.model.User;
import org.springframework.stereotype.Controller;
import org.springframework.ui.Model; // The core Model interface
import org.springframework.web.bind.annotation.GetMapping;

@Controller
public class UserController {

    // 1. Inject the Model interface as a method argument
    @GetMapping("/user/profile")
    public String getUserProfile(Model model) {
        
        // --- Simulation: Fetch data from a Service/Repository ---
        User currentUser = new User(101L, "Alice Johnson", "alice@example.com");
        
        // 2. Add data to the Model using a key-value pair
        // The key "user" will be used by the Thymeleaf/JSP template
        model.addAttribute("user", currentUser); 
        model.addAttribute("pageTitle", "User Profile");
        
        // 3. Return the logical view name
        return "user-details"; 
    }
}
```

-----

### 2\. Alternatives to the `Model` Interface

While the `Model` interface is the most direct way, Spring offers other return types and parameters for populating the data:

#### A. `ModelAndView` Object

The `ModelAndView` class is a wrapper that holds **both** the Model data and the logical View Name. This was common in older Spring versions but is less preferred than returning a `String` (view name) and using the separate `Model` parameter today.

```java
// Alternative using ModelAndView
@GetMapping("/user/mv")
public ModelAndView getUserProfileMv() {
    User currentUser = new User(102L, "Bob Smith", "bob@example.com");
    
    // Create ModelAndView, set data, and set view name
    ModelAndView mav = new ModelAndView("user-details");
    mav.addObject("user", currentUser);
    
    return mav; 
}
```

#### B. Return Type of the Model Object

If a Controller method's return type is a custom object (and it's not a `@RestController`), Spring will automatically add that return object to the Model under a key derived from the object's class name (default strategy). This is rarely used in standard web apps.

### 3\. Accessing Model Data in the View

Once the data is placed into the `Model`, the `ViewResolver` selects the appropriate view template. The template engine (e.g., **Thymeleaf** or **JSP**) then uses the data to render the final HTML.

#### Code Example: Thymeleaf View (`user-details.html`)

If using Thymeleaf (which we'll cover in a later section), the data access uses a special syntax (`${...}`).

```html
<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <title th:text="${pageTitle}">User Profile</title> 
</head>
<body>
    <h1>User Details</h1>
    
    <p>ID: <span th:text="${user.id}">101</span></p>
    <p>Name: <span th:text="${user.name}">Alice Johnson</span></p>
    <p>Email: <span th:text="${user.email}">alice@example.com</span></p>
    
</body>
</html>
```

The output sent to the client is the rendered HTML with the placeholder values replaced by the actual data from the Model.

