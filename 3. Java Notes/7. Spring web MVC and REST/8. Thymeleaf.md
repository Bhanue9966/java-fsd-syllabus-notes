# üåê 7. Spring Web MVC and REST

## 08-thymeleaf.md

### üå≥ Introduction to Thymeleaf

**Thymeleaf** is a modern, server-side Java template engine that is seamlessly integrated with the Spring Framework. It is the default and recommended view technology for Spring Boot, replacing older technologies like JSP.

#### Key Feature: Natural Templating

Thymeleaf templates are **Natural Templates**. This means they can be opened and displayed correctly by a standard web browser even before being processed by the server. This allows frontend developers to work on the design (HTML, CSS, JavaScript) without needing a running server, greatly speeding up development.

### 1\. Configuration (Spring Boot)

To use Thymeleaf, only one starter dependency is required. Spring Boot handles all the configuration, including setting up the `ThymeleafViewResolver` with sensible defaults.

#### Maven (`pom.xml`)

```xml
<dependency>
    <groupId>org.springframework.boot</groupId>
    <artifactId>spring-boot-starter-thymeleaf</artifactId>
</dependency>
```

#### Default Location

The `ThymeleafViewResolver` automatically looks for templates in the following location:

  * **Prefix:** `classpath:/templates/`
  * **Suffix:** `.html`

Therefore, a view named `"welcome"` maps to the file located at `src/main/resources/templates/welcome.html`.

### 2\. Core Thymeleaf Syntax

Thymeleaf works by adding special attributes, prefixed with **`th:`**, to standard HTML tags. These attributes tell the template engine how to process the data from the Spring **Model**.

| Syntax | Purpose | Description |
| :--- | :--- | :--- |
| `${...}` | **Variable Expression** | Accesses the values stored in the Spring Model. |
| `*{...}` | **Selection Expression** | Accesses properties of an object currently selected via `th:object`. |
| `@...` | **Link/URL Expression** | Used to create dynamic URLs, ensuring paths are context-aware. |
| `th:text` | **Text Substitution** | Replaces the inner text of the tag with the value of the variable expression. |
| `th:value` | **Input Value** | Sets the `value` attribute of an input field. |

### 3\. Code Example: Displaying Data (Read)

Assume the Controller adds a list of products to the Model under the key `"products"`.

#### Controller (`ProductController.java`)

```java
// Logic to prepare the Model data
@GetMapping("/list")
public String listProducts(Model model) {
    List<String> productNames = Arrays.asList("Monitor", "Keyboard", "Webcam");
    model.addAttribute("products", productNames);
    model.addAttribute("listTitle", "Available Stock");
    return "product-list"; // Maps to /templates/product-list.html
}
```

#### View (`src/main/resources/templates/product-list.html`)

```html
<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <title th:text="${listTitle}">Default Title</title>
</head>
<body>
    <h1>Products</h1>

    <ul>
        <li th:each="product : ${products}">
            <span th:text="${product}">Example Product Name</span>
        </li>
    </ul>
    
    <a th:href="@{/products/new}">Add New Product</a>
</body>
</html>
```

-----

### 4\. Code Example: Form Handling (Write/Update)

Thymeleaf is excellent for handling forms in conjunction with the `@ModelAttribute` feature.

#### View (`src/main/resources/templates/user-form.html`)

Assume the Controller has pre-loaded a `User` object into the Model under the key `"user"` (either a blank one for creation or an existing one for update).

```html
<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<body>
    <form th:action="@{/user/save}" th:object="${user}" method="post">
        
        <label>Username:</label>
        <input type="text" th:field="*{username}" />
        <br/>
        
        <label>Email:</label>
        <input type="email" th:field="*{email}" />
        <br/>
        
        <input type="hidden" th:field="*{id}" />

        <button type="submit">Submit User</button>
    </form>
</body>
</html>
```

  * **`th:object="${user}"`:** Selects the object from the Model that this form binds to.
  * **`th:field="*{username}"`:** This is the magic. It automatically generates the correct `id`, `name`, and `value` attributes for the HTML input, ensuring the submitted data correctly maps back to the `username` field of the `User` object parameter in the Controller's `@ModelAttribute` method.

The combination of Spring's `@ModelAttribute` and Thymeleaf's `th:field` makes form creation and data binding concise and type-safe.
