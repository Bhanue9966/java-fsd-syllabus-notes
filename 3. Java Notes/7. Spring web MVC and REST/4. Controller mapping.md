# üåê 7. Spring Web MVC and REST

## 04-controller-mapping.md

### üó∫Ô∏è Controller and Handler Mapping

Controller mapping is the process by which the **`DispatcherServlet`** identifies the specific Java method (the **handler method**) within a **`@Controller`** class that is designed to process an incoming HTTP request based on its URL path and HTTP method (GET, POST, etc.).

### 1\. The `@Controller` Annotation

The `@Controller` annotation is a specialization of `@Component`. It marks a class as a Spring component that contains handler methods capable of processing web requests.

#### Code Example: Defining the Controller

```java
package com.example.web;

import org.springframework.stereotype.Controller;
import org.springframework.web.bind.annotation.GetMapping;
import org.springframework.web.bind.annotation.RequestMapping;

@Controller // Marks the class as a request handler
public class ProductController {
    
    // ... handler methods will go here ...
}
```

### 2\. The `@RequestMapping` Annotation

This is the primary annotation for mapping web requests. It can be applied at both the **class level** and the **method level**.

#### A. Class-Level Mapping

Applying `@RequestMapping` to the class sets a **base URI path** for all methods within that controller. This is useful for grouping related endpoints and avoiding repetition.

```java
// Sets the base path for all methods in this controller to /products
@Controller
@RequestMapping("/products") 
public class ProductController {
    
    // ...
}
```

#### B. Method-Level Mapping

When applied to a method, `@RequestMapping` specifies the URL path **relative to the class-level path** and can define the acceptable **HTTP method**.

```java
@RequestMapping(value = "/list", method = RequestMethod.GET) // Maps to GET /products/list
public String listProducts() {
    // Logic to retrieve and display all products
    return "product-list";
}

@RequestMapping(value = "/create", method = RequestMethod.POST) // Maps to POST /products/create
public String createProduct() {
    // Logic to save a new product
    return "redirect:/products/list";
}
```

### 3\. HTTP Method-Specific Annotations (Shortcut)

Since using `RequestMethod.GET` inside `@RequestMapping` is verbose and less readable, Spring introduced specialized, composed annotations that are far more common in modern applications:

| Annotation | Equivalent to | Purpose |
| :--- | :--- | :--- |
| **`@GetMapping`** | `@RequestMapping(method = RequestMethod.GET)` | Read/Fetch data. |
| **`@PostMapping`** | `@RequestMapping(method = RequestMethod.POST)` | Submit/Create new data. |
| **`@PutMapping`** | `@RequestMapping(method = RequestMethod.PUT)` | Update existing data (replacement). |
| **`@DeleteMapping`** | `@RequestMapping(method = RequestMethod.DELETE)` | Delete data. |
| **`@PatchMapping`** | `@RequestMapping(method = RequestMethod.PATCH)` | Update existing data (partial modification). |

#### Code Example: Using Shortcut Annotations (Preferred Method)

```java
@Controller
@RequestMapping("/users") // Base path is /users
public class UserController {

    // 1. Maps to: GET /users
    @GetMapping 
    public String viewAllUsers() {
        System.out.println("Handling GET request for all users...");
        return "users/all";
    }

    // 2. Maps to: GET /users/101 (The path variable {id} is handled later)
    @GetMapping("/{id}") 
    public String viewUserDetail() {
        System.out.println("Handling GET request for a single user detail...");
        return "users/detail";
    }

    // 3. Maps to: POST /users/register
    @PostMapping("/register") 
    public String registerUser() {
        System.out.println("Handling POST request for user registration...");
        return "redirect:/users";
    }
}
```

### Summary of Request Flow

1.  **Request:** `POST /users/register` arrives at the `DispatcherServlet`.
2.  **Mapping:** The `DispatcherServlet` searches through all `@Controller` beans.
3.  **Match:** It finds the `UserController` with the base path `/users` and the `registerUser()` method with the path `/register` and method `POST`.
4.  **Execution:** The `registerUser()` method is executed.

This system of annotations allows developers to create clean, readable, and highly organized APIs where each controller method maps directly to a specific action and resource.

-----

The next concept is crucial for making these controllers dynamic: extracting data from the incoming HTTP request.
