# üíæ 8. Spring Data

## 09-react-integration-search.md

### üîç Integrating React for Search Functionality

To build a dynamic web application, the React frontend must communicate with the Spring Boot backend to retrieve data. The search functionality provides a perfect example of a **GET** request where the client passes parameters to the server, and the server returns a list of matching resources (JSON data).

### 1\. The Spring Boot Search Endpoint (Review)

The Spring backend exposes a REST endpoint that accepts a **request parameter** (`keyword`) and returns a list of `JobPostingDto` objects.

#### Spring Boot Controller Snippet:

```java
// Spring Boot (Backend)
@RestController
@RequestMapping("/api/jobs")
public class JobPostingController {

    // Maps to: GET /api/jobs/search?keyword={value}
    @GetMapping("/search")
    public List<JobPostingDto> searchJobs(@RequestParam String keyword) {
        // ... returns List<JobPostingDto> ...
    }
}
```

-----

### 2\. The React Frontend Architecture

The React application uses an asynchronous HTTP client (like the built-in `fetch` API or the popular **Axios** library) to call this endpoint.

#### A. React Component State

The component needs to manage three pieces of state:

1.  **`keyword`**: The text the user types into the search box.
2.  **`results`**: The list of job postings returned from the Spring API.
3.  **`isLoading`**: A flag to show a loading indicator during the API call.

#### B. Building the Request URL

The key is constructing the correct URL, including the query parameter:

```javascript
// Assuming backend runs on port 8080
const BASE_URL = 'http://localhost:8080/api/jobs/search';
const keyword = 'Java';

// Final URL needed by the server:
const API_URL = `${BASE_URL}?keyword=${keyword}`; 
// -> http://localhost:8080/api/jobs/search?keyword=Java
```

### 3\. Code Example: React Search Component

Here is a simplified React functional component demonstrating the search logic and API integration:

```javascript
// src/components/JobSearch.js

import React, { useState } from 'react';
import axios from 'axios'; // Using Axios for cleaner syntax

const JobSearch = () => {
  const [keyword, setKeyword] = useState('');
  const [results, setResults] = useState([]);
  const [isLoading, setIsLoading] = useState(false);
  const [error, setError] = useState(null);

  const handleSearch = async () => {
    setIsLoading(true);
    setError(null);
    setResults([]);

    try {
      // 1. Construct the API URL with the keyword request parameter
      const API_URL = `http://localhost:8080/api/jobs/search?keyword=${keyword}`;
      
      // 2. Make the asynchronous HTTP GET request
      const response = await axios.get(API_URL); 
      
      // 3. Update the state with the received JSON data (List<JobPostingDto>)
      setResults(response.data);

    } catch (err) {
      console.error('Search failed:', err);
      setError('Failed to fetch jobs. Check server connection.');
    } finally {
      setIsLoading(false);
    }
  };

  return (
    <div>
      <h2>Job Search</h2>
      <input
        type="text"
        placeholder="Enter keyword (e.g., Spring Boot)"
        value={keyword}
        onChange={(e) => setKeyword(e.target.value)}
      />
      <button onClick={handleSearch} disabled={isLoading}>
        {isLoading ? 'Searching...' : 'Search'}
      </button>

      {error && <p style={{ color: 'red' }}>{error}</p>}

      <h3>Results ({results.length})</h3>
      {/* 4. Map the results array to display job details */}
      {results.map((job) => (
        <div key={job.id} className="job-card">
          <h4>{job.title}</h4>
          <p>Company: {job.company}</p>
        </div>
      ))}
    </div>
  );
};

export default JobSearch;
```

### Summary of Integration

The search feature beautifully demonstrates the synergy between Spring and React:

1.  **React:** Manages the UI state and constructs the specific URL needed for the search.
2.  **HTTP Request:** The GET request is sent, including the **query parameter** in the URI.
3.  **Spring Boot:** The `DispatcherServlet` routes the request to the correct `@GetMapping` handler, using `@RequestParam` to extract the keyword.
4.  **JPA:** The Service layer executes the JPA query (e.g., `findByTitleContainingIgnoreCase`).
5.  **Response:** The `@RestController` serializes the resulting Java objects into a **JSON array**, which React receives and renders.
